<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Installing Tensorflow with GPU support on Linux (Debian) — Eric's Blog</title>
	<meta name="description" content="Title: Installing Tensorflow with GPU support on Linux (Debian); Date: 2018-01-16; Author: Eric Daoud">
	<meta name="author" content="Eric Daoud">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="https://ericdaat.github.io/theme/html5.js"></script>
		<![endif]-->
	<link href="https://ericdaat.github.io/theme/css/ipython.css" rel="stylesheet">
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
	<link href="//maxcdn.bootstrapcdn.com/bootswatch/3.2.0/simplex/bootstrap.min.css" rel="stylesheet">
	<link href="https://ericdaat.github.io/theme/css/local.css" rel="stylesheet">
	<link href="https://ericdaat.github.io/theme/css/pygments.css" rel="stylesheet">
</head>
<body>
<div class="container">
	<div class="page-header">
		<h1><a href="https://ericdaat.github.io/">Eric's Blog</a>
			<br><small>Data Scientist, Full Stack Developer</small></h1>	</div>
	<div class="row">
		<div class="col-md-8 col-md-offset-2">
<div class="article" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="text-center article-header">
		<h1 itemprop="name headline" class="article-title">Installing Tensorflow with GPU support on Linux (Debian)</h1>
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<h4 itemprop="name">Eric Daoud</h4>
		</span>
		<time datetime="2018-01-16T10:20:00+01:00" itemprop="datePublished">Tue 16 January 2018</time>
	</div>
	<div>
		Category:
		<span itemprop="articleSection">
			<a href="https://ericdaat.github.io/category/programming.html" rel="category">Programming</a>
		</span>
	</div>
	<div>
		Tags:
		<span itemprop="keywords">
			<a href="https://ericdaat.github.io/tag/tensorflow.html" rel="tag">tensorflow</a>
		</span>
		<span itemprop="keywords">
			<a href="https://ericdaat.github.io/tag/keras.html" rel="tag">keras</a>
		</span>
		<span itemprop="keywords">
			<a href="https://ericdaat.github.io/tag/code.html" rel="tag">code</a>
		</span>
		<span itemprop="keywords">
			<a href="https://ericdaat.github.io/tag/config.html" rel="tag">config</a>
		</span>
		<span itemprop="keywords">
			<a href="https://ericdaat.github.io/tag/server.html" rel="tag">server</a>
		</span>
		<span itemprop="keywords">
			<a href="https://ericdaat.github.io/tag/deep-learning.html" rel="tag">deep-learning</a>
		</span>
	</div>
	<div itemprop="articleBody" class="article-body"><p>Lately I spent some time using Deep Learning and configuring Linux servers with GPUs so the models train faster. In this short blog post I am going to list all what you have to follow in order to properly install the nvidia drivers, cuda, and other tools you'll need before running Tensorflow (or Keras) with GPU support. Let's get to it !</p>
<h2>Installing Nvidia Graphic Drivers and Cuda</h2>
<p>For this part, I followed instructions from the <a href="https://wiki.debian.org/NvidiaGraphicsDrivers">Debian Wiki</a>.</p>
<div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s2">&quot;deb http://httpredir.debian.org/debian/ stretch main contrib non-free&quot;</span> &gt; /etc/apt/sources.list
apt update
apt install linux-headers-<span class="k">$(</span>uname -r<span class="p">|</span>sed <span class="s1">&#39;s/[^-]*-[^-]*-//&#39;</span><span class="k">)</span> nvidia-driver
apt install nvidia-xconfig

reboot

apt-get install nvidia-cuda-dev nvidia-cuda-toolkit  nvidia-driver
</pre></div>


<h2>Installing Cudnn</h2>
<p>For this part, you're going to need to register as an Nvidia Developer. Then, download cudnn v6 (Tensorflow needs this version, at least it does while I'm writing these lines) from the <a href="https://developer.nvidia.com/rdp/cudnn-download">Nvidia Developer Website</a></p>
<div class="highlight"><pre><span></span><span class="nb">cd</span> /home/user
tar xvzf cudnn-8.0-linux-x64-v6.0.tgz
mkdir /usr/local/cuda
mkdir /usr/local/cuda/include
mkdir /usr/local/cuda/lib64
cp -P cuda/include/cudnn.h /usr/local/cuda/include
cp -P cuda/lib64/libcudnn* /usr/local/cuda/lib64
chmod a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda/lib64/libcudnn*

<span class="nb">echo</span> <span class="s2">&quot;export LD_LIBRARY_PATH=&quot;</span><span class="nv">$LD_LIBRARY_PATH</span>:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64<span class="s2">&quot;&quot;</span> &gt;&gt; .bashrc
<span class="nb">echo</span> <span class="s2">&quot;export CUDA_HOME=/usr/local/cuda&quot;</span> &gt;&gt; .bashrc

apt-get install libcupti-dev
</pre></div>


<h2>Installing python, virtualenv and tensforflow-gpu library</h2>
<p>This part is the easiest. You can see more details on the <a href="https://www.tensorflow.org/install/install_linux#InstallingVirtualenv">Tensorflow</a> page.</p>
<div class="highlight"><pre><span></span>apt-get install python python-pip
virtualenv tensorflow
<span class="nb">source</span> tensorflow/bin/activate
pip install tensorflow-gpu<span class="o">==</span><span class="m">1</span>.4 <span class="c1"># change to the version you need</span>
</pre></div>


<p>Et voila ! You should be able to run Tensorflow using GPUs on your Linux server. Just make sure it works by running this simple program:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<span class="n">hello</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="s1">&#39;Hello, TensorFlow!&#39;</span><span class="p">)</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hello</span><span class="p">))</span>
</pre></div>


<h2>Docker Image</h2>
<p>If you are familiar with <a href="https://www.docker.com/">Docker</a>, I'd recommend you have a look at the <a href="https://hub.docker.com/r/tensorflow/tensorflow/">Tensorflow Docker Image</a>. It's already configured with the latest drivers and can run on CPU or GPU.</p>
<p>If you're not familiar with Docker, you should definitely learn using it. Here are some links to get you started:
 - <a href="https://ericdaat.github.io/docker-introduction.html">My introduction to Docker blog post</a>
 - <a href="https://www.docker.com/">Docker official website</a>
 - <a href="https://docs.docker.com/get-started/">Docker getting started guide</a></p>
<h2>Install Keras on top of Tensorflow</h2>
<p>This step is not required, and some people probably prefer using Tensorflow directly with no abstraction layer on top of it. I personally started doing Deep Learning with Keras on top of Tensorflow, because it provided a simpler API, and I find it really easy and fast to build models.<br>
Keras was build by <a href="https://twitter.com/fchollet?lang=en">François Chollet</a>, and since he is now working for Google, Keras is very well integrated with Tensorflow.</p>
<p>Installing keras is as easy as <code>pip install keras</code>. It will automatically detect your GPUs if you have <code>tensorflow-gpu</code> installed, like we did.</p>
<p>To get started, have a look at the official <a href="https://keras.io/">Keras website</a> and their <a href="https://keras.io/#getting-started-30-seconds-to-keras">getting started guide</a>. I have also wrote a blog post with some <a href="https://ericdaat.github.io/keras-snippets.html">Keras snippets</a> that I find useful.</p>
<p>I hope this post was helpful, and have fun with Deep Learning !</p>
<iframe src="https://giphy.com/embed/W9zNtyI9I4lG" width="480" height="270" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>

<p><a href="https://giphy.com/gifs/neural-networks-W9zNtyI9I4lG">via GIPHY</a></p></div>
	<hr>
    <!-- <h2>Comments</h2> -->
</div>
		</div>
	</div> 	<!-- <hr> -->
</div> <!-- /container -->
<footer class="aw-footer bg-danger">
	<div class="container"> <!-- footer -->
		<div class="row">
			<div class="col-md-10 col-md-offset-1">
				<div class="row">
					<div class="col-md-3">
						<h4>Navigation</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="https://ericdaat.github.io">Eric's Blog</a></li>
							<li><a href="https://ericdaat.github.io//archives.html"><i class="fa fa-Archives "></i> Archives</a></li>
							<li><a href="https://ericdaat.github.io//categories.html"><i class="fa fa-Categories "></i> Categories</a></li>
							<li><a href="https://ericdaat.github.io/pages/about-me.html"><i class="fa fa-About me "></i> About me</a></li>
							<li><a href="https://ericdaat.github.io/feeds/all.atom.xml" type="application/atom+xml"><i class="fa fa-rss "></i> atom</a></li>
						</ul>
					</div>
					<div class="col-md-3">
						<h4>Author</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="https://github.com/ericdaat">Github</a></li>
							<li><a href="https://twitter.com/ericdaoud">Twitter</a></li>
							<li><a href="https://www.youtube.com/user/ericmusic13">Youtube</a></li>
							<li><a href="https://www.linkedin.com/in/ericdaoud/">Linkedin</a></li>
							<li><a href="https://500px.com/ericda">500px</a></li>
						</ul>
					</div>
					<div class="col-md-3">
						<h4>Categories</h4>
						<ul class="list-unstyled my-list-style">
							<li><a href="https://ericdaat.github.io/category/programming.html">Programming (8)</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
</footer>
<div class="container">
	<div class="row">
		<div class="col-md-12 text-center center-block aw-bottom">
			<p>&copy; Eric Daoud 2016</p>
			<p>Powered by Pelican</p>
		</div>
	</div>
</div>
<!-- JavaScript -->
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
	$("div.collapseheader").click(function () {
		$header = $(this).children("span").first();
		$codearea = $(this).children(".input_area");
		$codearea.slideToggle(500, function () {
			$header.text(function () {
				return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
			});
		});
	});
});
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-105599779-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>